<?xml version="1.0" encoding="utf-8"?>
<questsDict>
	<!-- Стартовый квест -->
	<questDesc id="startQuest" name="{start.quest.title}" description="{start.quest.description}">
	
		<!-- Шаг квеста имеет следующие параметры:
			label={строковое значение} - уникальный идентификатор метки, служит для создания условных переходов и циклов в сценарии
		Шаг содержит действия, выполняемые на этом этапе, условия завершения и награду, которая выдается в начале и по завершении шага -->
		<step>
			<!-- Награда, которая выдается при переходе на этот шаг -->
			<result>
				<!-- Выдать юзеру начальную базу в виде руин -->
				<giveBase id="4C3AC134-B7EF-4360-9915-39A6FB231071" asRuin="true"/>
			</result>
			<!-- Цели шага -->
			<stepTargets>
				<!-- Цель шага содержит в себе условие выполнения и награду, которую юзер получает по выполнении -->
				<stepTarget>
					<!-- Шаг завершится, как только будет создана хоть одна база -->
					<condition>
						<if>
							<trigger>basesCount</trigger>
							<min type="int">1</min>
						</if>
					</condition>
					<!-- Загрузить в склады начальные ресурсы и выставить соответствующие триггеры -->
					<result>
						<!-- Начальное содержимое складов -->
						<price>
							<resource id="cash" count="10"/>
							<resource id="food" count="500"/>
						</price>
						<!-- Захвачена одна (начальная) база -->
						<trigger id="capturedBases" value="1" type="set"/>
						<!-- Считать начальную базу захваченой -->
						<trigger id="centralTaken" value="1" type="set"/>
					</result>
				</stepTarget>
			</stepTargets>
		</step>
		<step>
			<stepTargets>
				<stepTarget>
					<!-- По прошествии 10 минут с вероятностью 30% в минуту выдать квест на первую вражескую базу -->
					<condition>
						<and>
							<if>
								<trigger>minutesLeft</trigger>
								<min type="int">10</min>
							</if>
							<random type="float">0.3</random>
						</and>
					</condition>
					<result>
						<!-- Выдача юзеру нового квеста поддерживает следующие параметры:
							id={строковое значение} - уникальный идентификатор квеста
							asSubquest=["true","false"] - флаг, указывающий выдавать квест как подквест, т. е. выполнение
								текущего квеста не продолжится вплоть до завершения выдаваемого (дочернего) -->
						<giveQuest id="firstEnemyBaseQuest" asSubquest="true"/>
					</result>
				</stepTarget>
			</stepTargets>
		</step>
		<step>
			<!-- Игра завершена -->
			<result>
				<gameOver/>
			</result>
		</step>
	</questDesc>
	
	<!-- Квест на первую вражескую базу -->
	<questDesc id="firstEnemyBaseQuest" name="{1st.enemy.quest.title}" description="{1st.enemy.quest.description}">
		<step>
			<stepTargets>
				<stepTarget>
					<!-- Если на стартовой базе игрока уже есть хоть один боевой юнит, напасть на базу игрока -->
					<condition>
						<if>
							<trigger>unitsCount</trigger>
							<value>4C3AC134-B7EF-4360-9915-39A6FB231071</value>
							<min type="int">1</min>
						</if>
					</condition>
					<result>
						<!-- Атака базы поддерживает следующие параметры:
							target={строковое значение} - идентификатор атакуемой базы
							departure={строковое значение} - база отправления экспедиции
							В качестве дочерних элементов выступает набор атакующих юнитов -->
						<attackBase target="4C3AC134-B7EF-4360-9915-39A6FB231071" departure="357D63E3-9BDB-4699-905B-5D6DD16D8048">
							<!-- Атакующий юнит поддерживает следующие параметры:
								id={строковое значение} - идентификатор атакующего юнита -->
							<attacker id="0796C85D-0BDF-4C46-8851-DF7E5DB92A8B"/>
						</attackBase>
					</result>
				</stepTarget>
				<stepTarget>
					<!-- Если на стартовой базе игрока пока нет ни одного боевого юнита, показать базу противника -->
					<condition>
						<not>
							<if>
								<trigger>unitsCount</trigger>
								<value>4C3AC134-B7EF-4360-9915-39A6FB231071</value>
							</if>
						</not>
					</condition>
					<result>
						<!-- Команда найти базу поддерживает следующие параметры:
							id={строковое значение} - уникальный идентификатор найденной базы -->
						<findBase id="357D63E3-9BDB-4699-905B-5D6DD16D8048"/>
					</result>
				</stepTarget>
			</stepTargets>
		</step>
		<step>
			<stepTargets>
				<!-- Юзер победил, квест завершается без награды, возвращаемся в вызывающий стартовый квест -->
				<stepTarget>
					<condition>
						<if>
							<trigger>ismailTaken</trigger>
						</if>
					</condition>
				</stepTarget>
				<!-- Юзер проиграл, игра завершена -->
				<stepTarget>
					<condition>
						<not>
							<if>
								<trigger>basesCount</trigger>
							</if>
						</not>
					</condition>
					<result>
						<gameOver/>
					</result>
				</stepTarget>
			</stepTargets>
		</step>
	</questDesc>
</questsDict>